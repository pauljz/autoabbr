!function(t){"use strict";var e,n,r,o,a,d,i,l,s,u;u={defTag:"abbr",attrKey:"data-definition",attrDef:"title",addClass:"definition",includeWord:"true",onComplete:null},t.fn.autoabbr=function(n){var o=this;t.extend(u,n),e={},u.words&&(e=u.words),u.src?t.get(u.src,function(n){t.extend(e,n),r(o)},"json"):r(o)},r=function(t){i(),a(t),"function"==typeof u.onComplete&&u.onComplete.call(t)},i=function(){var t={};for(var n in e)e.hasOwnProperty(n)&&l(n,t,0);d=t},l=function(t,e,n){var r=e[t[n]]||{};t[n+1]?l(t,r,n+1):r.word=!0,e[t[n]]=r},a=function(e){var n,r,d,i;for(d=e.children(),n=0,r=d.length;n<r;n++)a(t(d[n]));for(i=e.contents(),n=0,r=i.length;n<r;n++)3===i[n].nodeType&&o(i[n])},o=function(t){var e,r,o,a=[],i=t.nodeValue,l=d,s="",u="";for(e=0,r=i.length;e<r;e++)o=i[e].toLowerCase(),l.hasOwnProperty(o)?(l=l[o],s+=o):o.match(/^\W$/)?(l.word&&a.push({i:e,word:s,key:u||s}),u="",s="",l=d):l.hasOwnProperty("*")?(l={"*":!0,word:!0},u||(u=s+"*"),s+=o):l={};l.word&&a.push({i:e,word:s,key:u||s}),a.length&&n(t,a)},n=function(t,e){var n,r,o,a,d,i,l=[],u=0,c=t.nodeValue;for(d=0,i=e.length;d<i;d++)n=e[d],l.push({type:"text",text:c.slice(u,n.i-n.word.length)}),l.push({type:"word",text:c.slice(n.i-n.word.length,n.i),word:n.key}),u=n.i;for(l.push({type:"text",text:c.slice(u)}),r=t.parentNode,o=t.nextSibling,r.removeChild(t),d=0,i=l.length;d<i;d++)a=s(l[d]),null!==a&&r.insertBefore(a,o)},s=function(t){var n,r;return t.text&&0!==t.text.length?(t.word?(n=document.createElement(u.defTag),n.innerHTML=t.text,u.attrDef&&(r=e[t.word],u.includeWord&&(r=t.text+": "+r),n.setAttribute(u.attrDef,r)),u.attrKey&&n.setAttribute(u.attrKey,t.word),u.addClass&&(n.className=u.addClass)):n=document.createTextNode(t.text),n):null}}(jQuery);
